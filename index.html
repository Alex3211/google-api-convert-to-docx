<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Security-Policy"
    content="default-src * self blob: data: gap:; style-src * self 'unsafe-inline' blob: data: gap:; script-src * 'self' 'unsafe-eval' 'unsafe-inline' blob: data: gap:; object-src * 'self' blob: data: gap:; img-src * self 'unsafe-inline' blob: data: gap:; connect-src self * 'unsafe-inline' blob: data: gap:; frame-src * self blob: data: gap:;">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<script src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<body>
  <input type="file" id="file" style="display:none;" />
  <button id="button" name="button" value="Upload" onclick="handleUploadFile();">Upload</button>
</body>

</html>
<script>
  function handleUploadFile() {
    document.getElementById("file").click();
  };
  $(document).ready(async function () {
    let html = '';
    $("#file").on('change', async function (e) {
      console.dir(e)
      var file = $("#file")[0].files[0];
      if (file) {
        var reader = new FileReader();
        await reader.readAsText(file, "UTF-8");
        reader.onload = async function (evt) {
          html = evt.target.result;
          const result = await axios.post('http://localhost:3333', { html }, {
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded'
            },
            responseType: 'blob'
          })
          var fileName = 'document.docx'
          var a = document.createElement("a");
          document.body.appendChild(a);
          a.style = "display: none";
          var url = window.URL.createObjectURL(result.data);
          a.href = url;
          a.download = fileName;
          a.click();
          window.URL.revokeObjectURL(url);
          console.dir(result)
        }
        reader.onerror = function (evt) {
        }
      }
    });
  });

</script>